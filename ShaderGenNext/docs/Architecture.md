# ShaderGenNext 架构文档

## 系统架构图

```
┌─────────────────────────────────────────────────────────────────┐
│                      应用层 (Application Layer)                  │
│  ┌──────────────┐  ┌──────────────┐  ┌──────────────┐         │
│  │ 游戏逻辑      │  │ 渲染系统      │  │ 编辑器工具    │         │
│  └──────────────┘  └──────────────┘  └──────────────┘         │
└─────────────────────────────────────────────────────────────────┘
                              │
                              ▼
┌─────────────────────────────────────────────────────────────────┐
│                   ShaderGenNext API Layer                        │
│  ┌──────────────┐  ┌──────────────┐  ┌──────────────┐         │
│  │MaterialBuilder│  │ ShaderGraph  │  │ MaterialLib  │         │
│  └──────────────┘  └──────────────┘  └──────────────┘         │
└─────────────────────────────────────────────────────────────────┘
                              │
                              ▼
┌─────────────────────────────────────────────────────────────────┐
│                      核心层 (Core Layer)                         │
│  ┌──────────┐  ┌──────────┐  ┌──────────┐  ┌──────────┐      │
│  │TypeSystem│  │ShaderNode│  │  Result  │  │ShaderCtx │      │
│  └──────────┘  └──────────┘  └──────────┘  └──────────┘      │
└─────────────────────────────────────────────────────────────────┘
                              │
         ┌────────────────────┼────────────────────┐
         ▼                    ▼                    ▼
┌─────────────────┐  ┌─────────────────┐  ┌─────────────────┐
│  编译器层         │  │   缓存层         │  │   材质层         │
│ (Compiler)       │  │   (Cache)        │  │  (Materials)    │
│                  │  │                  │  │                  │
│ ┌─────────────┐ │  │ ┌─────────────┐ │  │ ┌─────────────┐ │
│ │SPIRVBackend │ │  │ │ShaderCache  │ │  │ │PBRMaterial  │ │
│ ├─────────────┤ │  │ ├─────────────┤ │  │ ├─────────────┤ │
│ │GLSLBackend  │ │  │ │CachePolicy  │ │  │ │UnlitMaterial│ │
│ ├─────────────┤ │  │ ├─────────────┤ │  │ ├─────────────┤ │
│ │HLSLBackend  │ │  │ │CacheStorage │ │  │ │CustomMat    │ │
│ ├─────────────┤ │  │ └─────────────┘ │  │ └─────────────┘ │
│ │MetalBackend │ │  │                  │  │                  │
│ └─────────────┘ │  │ L1: Memory Cache│  │                  │
│                  │  │ L2: Disk Cache  │  │                  │
│                  │  │ L3: Net Cache   │  │                  │
└─────────────────┘  └─────────────────┘  └─────────────────┘
         │                    │                    │
         └────────────────────┼────────────────────┘
                              ▼
┌─────────────────────────────────────────────────────────────────┐
│                    平台层 (Platform Layer)                       │
│  ┌──────────┐  ┌──────────┐  ┌──────────┐  ┌──────────┐      │
│  │  Vulkan  │  │  OpenGL  │  │DirectX 12│  │  Metal   │      │
│  └──────────┘  └──────────┘  └──────────┘  └──────────┘      │
└─────────────────────────────────────────────────────────────────┘
```

详细架构设计、类图、数据流图请参考完整文档。

---

**版本**: 1.0  
**日期**: 2025-12-30  
**作者**: ShaderGenNext 设计团队
